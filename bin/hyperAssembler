#!/bin/bash

# Read a fasta file and concatenate all of the sequences into a single contig.

if [[ -z "$@" ]]; then
    echo 'You must supply a fasta file (e.g. megaAssembler human.fastq)'
    exit 1
fi

if [[ ${#@} -gt 1 ]]; then
    echo 'hyperAssembler only takes one argument (e.g. megaAssembler human.fasta)'
    exit 1
fi
echo "Assembling genome in $@"

echo "Start time: `date +%r`"

export contig=''

while read -r line; do
    [[ "$line" =~ ^\> ]] || contig="${contig}${line}"
done < "$@"


sleep 5

echo ${#contig}
half=`expr ${#contig} / 2`
echo $half


echo "Finished assembling ${@}.  Writing contigs into ${@}.contigs."
echo "> contig1" > "${@}.contigs"
echo "$contig" | cut -c-${half} >> "${@}.contigs"
half=`expr $half + 1`
echo "> contig2" >> "${@}.contigs"
echo "$contig" | cut -c${half}- >> "${@}.contigs"
echo "End time: `date +%r`"
echo 'Done'

